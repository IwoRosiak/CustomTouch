<?xml version="1.0" encoding="utf-8" ?>
<Patch>
  <Operation Class="PatchOperationSequence">
    <operations>
      <li Class="PatchOperationConditional">
        <xpath>*/ThingDef[@ParentName="BaseHumanMakeableGun"]/comps</xpath>
        <nomatch Class="PatchOperationAdd">
          <xpath>*/ThingDef[@ParentName="BaseHumanMakeableGun"]</xpath>
          <value>
            <comps>
              <li Class="GunNut.GN_AttachmentCompProperties">
                <jobDefInstall>EquipAttachment</jobDefInstall>
                <jobDefRemove>RemoveAttachment</jobDefRemove>
                <slots>
                  <li>
                    <weaponPart>scope</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(0.17,0)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>magazine</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(-0.1,-0.1)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>stock</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(0,-0.35)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>barrelExt</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(0,0.55)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>receiver</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(0,0)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>undermount</weaponPart>
                    <defaultPosition>(-0.1,0.3)</defaultPosition>
                    <isActive>false</isActive>
                  </li>
                  <li>
                    <weaponPart>debug</weaponPart>
                    <isActive>false</isActive>
                  </li>
                </slots>
              </li>
            </comps>
          </value>
        </nomatch>
        <match Class="PatchOperationAdd">
          <xpath>*/ThingDef[@ParentName="BaseHumanMakeableGun"]/comps</xpath>
          <value>
              <li Class="GunNut.GN_AttachmentCompProperties">
                <jobDefInstall>EquipAttachment</jobDefInstall>
                <jobDefRemove>RemoveAttachment</jobDefRemove>
                <slots>
                  <li>
                    <weaponPart>scope</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(0.17,0)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>magazine</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(-0.1,-0.1)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>stock</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(0,-0.35)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>barrelExt</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(0,0.55)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>receiver</weaponPart>
                    <isActive>false</isActive>
                    <defaultPosition>(0,0)</defaultPosition>
                  </li>
                  <li>
                    <weaponPart>undermount</weaponPart>
                    <defaultPosition>(-0.1,0.3)</defaultPosition>
                    <isActive>false</isActive>
                  </li>
                  <li>
                    <weaponPart>debug</weaponPart>
                    <isActive>false</isActive>
                  </li>
                </slots>
              </li>
          </value>
        </match>
      </li>

      <li Class="PatchOperationReplace">
        <xpath>*/ThingDef[defName="Gun_BoltActionRifle"]/comps/li[@Class="GunNut.GN_AttachmentCompProperties"]/slots</xpath>
        <value>
          <slots>
            <li>
              <weaponPart>scope</weaponPart>
              <isActive>true</isActive>
              <defaultPosition>(0.17,0)</defaultPosition>
            </li>
            <li>
              <weaponPart>magazine</weaponPart>
              <isActive>true</isActive>
              <defaultPosition>(-0.1,-0.1)</defaultPosition>
            </li>
            <li>
              <weaponPart>stock</weaponPart>
              <isActive>true</isActive>
              <defaultPosition>(0,-0.35)</defaultPosition>
            </li>
            <li>
              <weaponPart>barrelExt</weaponPart>
              <isActive>true</isActive>
              <defaultPosition>(0,0.55)</defaultPosition>
            </li>
            <li>
              <weaponPart>receiver</weaponPart>
              <isActive>true</isActive>
              <defaultPosition>(0,0)</defaultPosition>
            </li>
            <li>
              <weaponPart>undermount</weaponPart>
              <defaultPosition>(-0.1,0.3)</defaultPosition>
              <isActive>true</isActive>
            </li>
            <li>
              <weaponPart>debug</weaponPart>
              <isActive>true</isActive>
            </li>
          </slots>
        </value>
      </li>

      <li Class="PatchOperationAdd">
        <xpath>*/ThingDef[defName="Gun_BoltActionRifle"]/comps/li[@Class="GunNut.GN_AttachmentCompProperties"]</xpath>
        <value>
          <tags>
            <li>boltAction</li>
            <li>undermount</li>
          </tags>
        </value>
      </li>
<!--
      <li Class="PatchOperationAdd">
        <xpath>*/ThingDef[defName="Gun_AssaultRifle"]/comps</xpath>
        <value>
            <li Class="GunNut.GN_AttachmentCompProperties">
              <jobDefInstall>EquipAttachment</jobDefInstall>
              <jobDefRemove>RemoveAttachment</jobDefRemove>
              <slots>
                <li>
                  <weaponPart>scope</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(0.17,0)</defaultPosition>
                </li>
                <li>
                  <weaponPart>magazine</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(-0.1,-0.1)</defaultPosition>
                </li>
                <li>
                  <weaponPart>stock</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(0,-0.35)</defaultPosition>
                </li>
                <li>
                  <weaponPart>barrelExt</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(0.55,0.55)</defaultPosition>
                </li>
                <li>
                  <weaponPart>receiver</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(0,0)</defaultPosition>
                </li>
                <li>
                  <weaponPart>undermount</weaponPart>
                  <defaultPosition>(-0.1,0.3)</defaultPosition>
                  <isActive>true</isActive>
                </li>
                <li>
                  <weaponPart>debug</weaponPart>
                  <isActive>true</isActive>
                </li>
              </slots>
            </li>
        </value>
      </li>

      <li Class="PatchOperationAdd">
        <xpath>*/ThingDef[@ParentName="BaseHumanMakeableGun"]/comps</xpath>
        <value>
          <li>
            <li Class="GunNut.GN_AttachmentCompProperties">
              <jobDefInstall>EquipAttachment</jobDefInstall>
              <jobDefRemove>RemoveAttachment</jobDefRemove>
              <slots>
                <li>
                  <weaponPart>scope</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(0.2,0)</defaultPosition>
                </li>
                <li>
                  <weaponPart>magazine</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(-0.15,-0.1)</defaultPosition>
                </li>
                <li>
                  <weaponPart>stock</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(-0.05,-0.35)</defaultPosition>
                </li>
                <li>
                  <weaponPart>barrel</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(0.3,0)</defaultPosition>
                </li>
                <li>
                  <weaponPart>barrelExt</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(0,0.6)</defaultPosition>
                </li>
                <li>
                  <weaponPart>receiver</weaponPart>
                  <isActive>true</isActive>
                  <defaultPosition>(0.5,0)</defaultPosition>
                </li>
                <li>
                  <weaponPart>grip</weaponPart>
                  <isActive>true</isActive>
                </li>
                <li>
                  <weaponPart>foregrip</weaponPart>
                  <isActive>true</isActive>
                </li>
                <li>
                  <weaponPart>undermount</weaponPart>
                  <isActive>true</isActive>
                </li>
                <li>
                  <weaponPart>debug</weaponPart>
                  <isActive>true</isActive>
                </li>
              </slots>
            </li>
          </li>
        </value>
      </li>

    -->
    </operations>
  </Operation>

  <Operation Class="PatchOperationAttributeSet">
    <xpath>/Defs/StatDef[@Name="AccuracyBase"]/parts/li</xpath>
    <attribute>Class</attribute>
    <value>GunNut.GN_StatPart_Quality</value>
  </Operation>
  
  <Operation Class="PatchOperationAdd">
    <xpath>/Defs/StatDef[defName="MarketValue"]/parts</xpath>
    <value>
      <li Class="GunNut.IR_StatPart_MarketValue">
      </li>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>/Defs/StatDef[defName="RangedWeapon_Cooldown"]</xpath>
    <value>
      <parts>
        <li Class="GunNut.GN_StatPart_Attachment">
        </li>
      </parts>
    </value>
  </Operation>
  
  <!--<Operation Class="PatchOperationAttributeSet">
    <xpath>/Defs/StatDef[defName="RangedWeapon_DamageMultiplier"]/parts/li</xpath>
    <attribute>Class</attribute>
    <value>GunNut.GN_StatPart_Quality</value>
  </Operation>-->

</Patch>
